% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/LoadData.R
\name{load_geodiva_forms}
\alias{load_geodiva_forms}
\title{Load stratigraphic data from GeoDIVA upload forms}
\usage{
load_geodiva_forms(station_sample_upload, layer_upload)
}
\arguments{
\item{station_sample_upload}{data frame created from uploaded GeoDIVA format
Station/Sample upload sheet, usually uploaded with \code{readxl::read_xlsx()}
linked to filepath.}

\item{layer_upload}{data frame created from uploaded GeoDIVA format
Layers upload sheet, usually uploaded with \code{readxl::read_xlsx()}
linked to filepath.}
}
\value{
A named list with three elements:
\describe{
\item{data_strat}{A data frame containing the merged and cleaned stratigraphic
data, ready for further analysis.}
\item{SectionList}{A character vector of unique stratigraphic section names
present in the input data.}
\item{stations}{A data frame of cleaned station metadata, with conflicts
resolved and one row per station.}
}
}
\description{
\code{load_geodiva_forms()} processes and cleans stratigraphic data from GeoDIVA
upload forms, specifically a form that includes Station and Sample data and
another form that includes the Layer data. It merges these datasets,
resolves any conflicts in key fields, and prepares a consolidated dataset
for further analysis. The function also extracts and prints a list of unique
stratigraphic sections.
}
\examples{
# Locate the example Excel files shipped with the package
path_samples <- system.file("extdata", "example_samples_stations_upload_2024.xlsx",
  package = "avstrat"
)
path_layers <- system.file("extdata", "example_layers_upload_2024.xlsx",
  package = "avstrat"
)

# Read them with readxl (only if readxl is available)
if (requireNamespace("readxl", quietly = TRUE)) {
  station_sample_upload <- readxl::read_xlsx(path_samples, sheet = "Data")
  layer_upload <- readxl::read_xlsx(path_layers, sheet = "Data")

 result <- load_geodiva_forms(station_sample_upload, layer_upload)
 head(result$data_strat)
 result$SectionList
 head(result$stations)
}
}
